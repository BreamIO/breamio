<html>
	<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>Eye Stream</title>
	<link rel="stylesheet" media="screen" type="text/css" href="colorpicker.min.css" />
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="colorpicker.min.js"></script>
	<script src="/api/eyestream.js"></script>
	<script>
	function sendData(){
		var thickness = parseInt(document.getElementById("thickness").value);
		var radius = parseInt(document.getElementById("radius").value);
		var color = parseInt("0x" + (document.getElementById("color").value));
		var maxLength = parseInt(document.getElementById("maxLength").value);

		// If thickness is greater than radius * 2, the behaviour is undefined (looks wierd)
		if (radius < 0) {
			radius = 0
		}

		if (thickness < 0) {
			thickness = 0
		}

		if (thickness > radius * 2) {
			thickness = radius * 2
		}

		if (maxLength < 1) {
			maxLength = 1
		} else if (maxLength > 30) {
			maxLength = 30
		}

		var config =
		{
			"Thickness": thickness,
			"Alpha" : 1,
			"Radius" : radius,
			"Color": [color],
			"MaxLength": maxLength
		};
		EyeStream.command("drawer:settings", 1, config);
	}
	$(function(){
		$('#color').ColorPicker({
			onSubmit: function(hsb, hex, rgb, el, parent) {
				$(el).val(hex);
				$(el).ColorPickerHide();
			},
			onBeforeShow: function () {
				$(this).ColorPickerSetColor(this.value);
			},
			onChange: function (hsb, hex, rgb) {
				$('#color').val(hex);
			}
		})
		.on('keyup', function(){
			$(this).ColorPickerSetColor(this.value);
		});
	});

	</script>

</head>
	<body>
		<h1>Eye Stream</h1>
		<div>
			<header>Radius:</header>
			<input id="radius" size="6" value = "30" />
		<div/>
		<div>
			<header>Thickness:</header>
			<input id="thickness" size="6" value="3" />
		<div/>
		<div>
			<header>Trail Length:</header>
			<input id="maxLength" size="6" value = "10" />
		<div/>
		<div>
			<header>Color:</header>
			<input type="text" id="color" maxlength="6" size="6" value="0015FF">
		<div/>
		<br>
		<button onclick="sendData()">Update</button>
	</body>
</html>

